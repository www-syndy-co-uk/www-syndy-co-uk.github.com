define("LogonService",["jquery"],function(e){function n(e){this.apiRoot=e}var t=e;return n.prototype.checkLoggedInStatus=function(e,n){e=e||"/",n=n||"/";var e="/authentication/redirectToBlog?destUrl="+e,n="/authentication/redirectToBlog?destUrl="+n,r=this.apiRoot+"/authentication/loginInfo?postLoginUrl="+encodeURIComponent(e)+"&postLogoutUrl="+encodeURIComponent(n);return r+="&callback=?",t.getJSON(r)},n}),define("syndy/ui/login-button",["jquery","LogonService"],function(e,t){var n=e(".login-info"),r=n.find("button.login"),i=n.find("button.logout"),s=null,o=new t(syndy.apiRoot),u=n.find(".throbber");u.show(),n.on("click","button.login",function(e){var t=s.loginUrl;t.indexOf("http")!==0&&(t=syndy.apiRoot+t),window.location.href=t}),n.on("click","button.logout",function(e){var t=s.logoutUrl;t.indexOf("http")!==0&&(t=syndy.apiRoot+t),window.location.href=t});var a=window.location.pathname,f=window.location.pathname;o.checkLoggedInStatus(a,f).done(function(e){u.hide(),s=e,syndy.loginInfo=e;if(s.isUserLoggedIn){var t=s.isUserAdmin?"[A]":"";n.find("span").html(s.user.nickname+" "+t).show(),i.show()}else r.show()})}),define("OddsService",["jquery"],function(e){function n(e,n){return e+=e.indexOf("?")>-1?"&":"?",e+="callback=",e+="?",t.getJSON(e,n).pipe(function(e){return"string"==typeof e?JSON.parse(e):e})}function r(e,t){var r=this;e=e||"//api.syndy.co.uk",t=t||"",t&&(e=e+":"+t),this.matches=[],this.match=null,this.matchSummaries=null,this.loadMatches=function(){var t=e+"/odds/matches";return n(t).done(function(e){r.matches=e})},this.loadMatch=function(t){var i=e+"/odds/matches?matchId="+t;return n(i).done(function(e){r.match=e,r.matches.push(e)})},this.loadMatchSummaries=function(){var t=e+"/odds/matchSummaries";return n(t).done(function(e){r.matchSummaries=e})}}var t=e;return r}),define("TeamIcons",["underscore"],function(e){function t(){var t=this.icons={},n="http://upload.wikimedia.org/wikipedia/commons/thumb";t["Bradford Bulls"]="/e/eb/Bullscolours.svg/16px-Bullscolours.svg.png",t["Castleford Tigers"]="/f/fd/Castleford_colours.svg/16px-Castleford_colours.svg.png",t["Catalan Dragons"]="/0/0c/Catalanscolours.svg/16px-Catalanscolours.svg.png",t["Huddersfield Giants"]="/7/73/Giantscolours.svg/16px-Giantscolours.svg.png",t["Hull FC"]="/6/65/Hullcolours.svg/16px-Hullcolours.svg.png",t["Hull Kingston Rovers"]="/8/8f/HKRcolours.svg/16px-HKRcolours.svg.png",t["Leeds Rhinos"]="/5/5f/Rhinoscolours.svg/16px-Rhinoscolours.svg.png",t["London Broncos"]="/f/f8/Quinscolours.svg/16px-Quinscolours.svg.png",t["Harlequins RL"]="/f/f8/Quinscolours.svg/16px-Quinscolours.svg.png",t["Salford Red Devils"]="/8/81/Redscolours.svg/16px-Redscolours.svg.png",t["St. Helens"]="/5/5e/Saintscolours.svg/16px-Saintscolours.svg.png",t["Wakefield Wildcats"]="/e/e8/Wcatscolours.svg/16px-Wcatscolours.svg.png",t["Warrington Wolves"]="/f/fd/Wolvescolours.svg/16px-Wolvescolours.svg.png",t["Widnes Vikings"]="/e/ec/Widnes_colours.svg/16px-Widnes_colours.svg.png",t["Wigan Warriors"]="/c/c0/Wigancolours.svg/16px-Wigancolours.svg.png",e.each(t,function(e,r){t[r]=n+e}),t.Bradford=t["Bradford Bulls"],t.Castleford=t["Castleford Tigers"],t["Catalans Dragons"]=t["Catalan Dragons"],t.Huddersfield=t["Huddersfield Giants"],t.Hull=t["Hull FC"],t["Hull K R"]=t["Hull Kingston Rovers"],t.Leeds=t["Leeds Rhinos"],t.Salford=t["Salford Red Devils"],t["St Helens"]=t["St. Helens"],t.Wakefield=t["Wakefield Wildcats"],t.Warrington=t["Warrington Wolves"],t.Widnes=t["Widnes Vikings"],t.Wigan=t["Wigan Warriors"]}return t.prototype.getIconUrl=function(e){return this.icons[e]},t.prototype.keys=function(){return e.keys(this.icons)},t}),define("syndy/ui/latest-odds",["jquery","underscore","OddsService","TeamIcons"],function(e,t,n,r){function o(t){function u(t){var r=(new Date).getTime()-n;e(".loadTime").text("Loaded "+t+" markets in "+r+"ms"),e(".loading").hide(),e(".filter").show(),l.resolve(c)}function f(e){var t=++o===s;t&&u(s);var n=e,i=a(n);i&&r.append(i)}var n=(new Date).getTime(),r=e(".matches").first();r.html(""),e(".loading").show(),e(".filter").hide();var s=0,o=0,l=e.Deferred(),c={};return i.loadMatchSummaries().done(function(n,o,a){s=0,c.matchSummaries=n;if(n.length<1){u(0);return}for(var l=0;l<n.length;l++){var h=n[l],p=t(h);p&&function(e,t){t.html(h.team1+" v "+h.team2),r.append(t),s++,i.loadMatch(h.id).done(function(n){c.matches=c.matches||[],c.matches[e]=n,t.remove(),f.call(this,n)})}(l,e("<div/>"))}0==s&&u(0)}).fail(function(e,t,n){alert(t),console.log(e,t,n)}),l.promise()}function u(){function e(e){return s.getIconUrl(e.team1)||s.getIconUrl(e.team2)?!0:!1}var t=window.location.href.indexOf("superLeagueOnly")>-1;return t?e:function(){return!0}}function a(n){function r(e){if(!e)return"?";var t=e.asFraction,n=e.asDouble;return t?""+t.numerator+"/"+t.denominator:n}function i(t){var n=t.bet1||{},i=t.bet2||{},o=s.getIconUrl(n.name),u=s.getIconUrl(i.name),a="http://upload.wikimedia.org/wikipedia/commons/c/ce/Transparent.gif",f={bet1:e.extend({},n,{odds:r(n.odds)}),bet2:e.extend({},i,{odds:r(i.odds)}),draw:{odds:t.draw?r(t.draw.odds):""},src1:o?o:a,src2:u?u:a},c=e(l(f));return c}if(!n.bets||n.bets.length<1)return null;var o=e("#matchTemplate").html().trim(),u=t.template(o),a=e(u({match:n})),f=e("#betTemplate").html().trim(),l=t.template(f),c=a.find(".bets tbody");n.bets.sort(function(e,t){return e.bookmaker<t.bookmaker?-1:e.bookmaker>t.bookmaker?1:0});var h={};e(n.bets).each(function(e,t){t.handicap&&t.handicap.length>0&&t.handicap[0]=="+"&&(t.handicap=t.handicap.substring(1));if(null!=h.bookmaker&&t.bookmaker!=h.bookmaker){var r=i(h);c.append(r),h={}}"Draw"===t.name?h.draw=t:n.team1===t.name?h.bet1=t:h.bet2=t,h.bookmaker=t.bookmaker});var p=i(h);return c.append(p),a}function f(){function t(e){var t=e.indexOf("/");return t<0?parseFloat(e):parseInt(e.substring(0,t).trim())/parseInt(e.substring(t+1).trim())}function n(e,t){return e=e.substring(1,e.length-1),t=t.substring(1,t.length-1),e?t?r(e,t):1:-1}function r(e,n){return t(e)-t(n)}function i(e,t){var n=e==t;return n?0:e>t?-1:1}function s(e,t){return e.length>0&&e[0]=="+"&&(e=e.substring(1)),t.length>0&&t[0]=="+"&&(t=t.substring(1)),parseFloat(e)-parseFloat(t)}var o=[i,null,r,s,n,s,r,null];e(document).on("click","tr.bet>td",function(t){var n=e(this),r=n.parent(),i=r.children().index(n),s=o[i];if(!s)return;var u=r.closest("tbody"),a=u.find("tr"),f=r.parent();a.remove(),a.sort(function(t,n){var r=e(t).children().eq(i),o=e(n).children().eq(i),u=r.text(),a=o.text();return s(u,a)}),f.append(a)})}var i=new n(syndy.apiRoot,window.location.port),s=new r;return{loadMatches:o,findFilter:u,init:f}}),define("main",["syndy/ui/login-button","syndy/ui/latest-odds"],function(){});